USE MASTER

EXEC XP_CREATE_SUBDIR 'C:\DADOS'
GO

IF EXISTS(SELECT 1 FROM SYS.DATABASES WHERE NAME = 'DEMO') 
BEGIN
	ALTER DATABASE DEMO 
	SET SINGLE_USER WITH ROLLBACK IMMEDIATE
  
	DROP DATABASE DEMO
END

CREATE DATABASE DEMO
WITH FILESTREAM
(
	NON_TRANSACTED_ACCESS = FULL,
	DIRECTORY_NAME = 'DADOS'
)
GO

ALTER DATABASE DEMO
  ADD FILEGROUP DEMO_FG
  CONTAINS FILESTREAM

ALTER DATABASE DEMO
ADD FILE
(
    NAME= 'DEMO_FILE',
    FILENAME = 'C:\DADOS\DEMO_FILE'
)
TO FILEGROUP DEMO_FG

GO

USE DEMO

CREATE TABLE TABELA AS FILETABLE
WITH
(
	FILETABLE_DIRECTORY = 'SHAREDFILES',
	FILETABLE_COLLATE_FILENAME = DATABASE_DEFAULT
)

SELECT 
	*
FROM 
	TABELA
